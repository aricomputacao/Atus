<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:composite="http://java.sun.com/jsf/composite"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:comp="http://java.sun.com/jsf/composite/comp"
                xmlns:util="http://java.sun.com/jsf/composite/util"
                xmlns:consultas="http://java.sun.com/jsf/composite/consultas">

    <composite:interface id="interCon">
        <composite:attribute id="nome" name="nome" default="Consulta" shortDescription="Cabeçalho do panelGrid" />
        <composite:attribute  name="legend" default="Cadastro" shortDescription="Cabeçalho do fieldset" />

    </composite:interface>
    <composite:implementation  >
        <p:fieldset id="fieldCad" rendered="#{navegacaoMB.permissaoIncluir(navegacao['pro.processo'])}" legend="#{cc.attrs.legend}"  >            
            <h:panelGrid>
            <h:outputText rendered="#{processoMB.processo.id != null}" style="font-size:20px;font-weight: bold" value="&rsaquo;&rsaquo; Id: #{processoMB.processo.id}"/>
            <h:outputText rendered="#{processoMB.processo.id != null}" style="font-size:20px;font-weight: bold" value="&rsaquo;&rsaquo; Cliente: #{processoMB.processo.cliente.pessoa.nome}"/>
            </h:panelGrid>
            <p:tabView id="tbView" dynamic="true" >
                <p:tab id="tabDadosGer" title="Dados Gerais">
                    <h:panelGrid columns="2" >
                        <h:panelGrid columns="2"   >
                            <h:panelGrid id="grdEndere">
                                <h:panelGrid columns="2" >
                                    <p:outputLabel value="Endereçamento" for="trat"/>
                                </h:panelGrid>
                                <h:panelGrid columns="2">
                                    <p:selectOneMenu id="trat" effect="fade" style="width: 250px" converter="#{indexConverter}" value="#{processoMB.processo.enderecamento}" required="true"   >
                                        <f:selectItems value="#{enderecamentoMB.listaEnderecamentos}" var="end" itemLabel="#{end.nome}" itemValue="#{end}"/>
                                    </p:selectOneMenu>
                                    <p:commandButton onclick="PF('dialogoEnderecamento').show()" immediate="true" icon="ui-icon-circle-plus"/>
                                </h:panelGrid>
                            </h:panelGrid>
                            <h:panelGrid>
                                <h:panelGrid columns="2" >
                                    <p:outputLabel value="Colaborador" for="col"/>
                                </h:panelGrid>
                                <h:panelGrid columns="2">
                                    <p:selectOneMenu id="col" effect="fade" style="width: 350px" converter="#{indexConverter}" value="#{processoMB.processo.colaborador}"    >
                                        <f:selectItem itemLabel="------------  Selecione  --------------" itemValue="#{null}" /> 
                                        <f:selectItems value="#{colaboradorMB.listaColaboradors}" var="col" itemLabel="#{col.pessoa.nome}" itemValue="#{col}"/>
                                    </p:selectOneMenu>
                                </h:panelGrid>
                            </h:panelGrid>
                            <h:panelGrid >
                                <comp:inputText nomeLabel="Número" size="20" value="#{processoMB.processo.numero}"/>
                            </h:panelGrid>
                            <h:panelGrid id="grdTipCon">
                                <h:panelGrid columns="2" >
                                    <p:outputLabel value="Tipo de Contrato" for="tip"/>
                                </h:panelGrid>
                                <h:panelGrid columns="2">
                                    <p:selectOneMenu id="tip" effect="fade" style="width: 350px" converter="#{indexConverter}" value="#{processoMB.processo.tipoContrato}" required="true"   >
                                        <f:selectItems value="#{tipoContratoMB.listaTipoContrados}" var="tp" itemLabel="#{tp.nome}" itemValue="#{tp}"/>
                                    </p:selectOneMenu>
                                    <p:commandButton onclick="PF('dialogoTipoContrato').show()" immediate="true" icon="ui-icon-circle-plus"/>
                                </h:panelGrid>
                            </h:panelGrid>
                            <h:panelGrid >
                                <comp:inputTextCalendar nomeLabel="Data Cadastro" size="15" valorData="#{processoMB.processo.dataCadastro}"/>
                            </h:panelGrid>                     
                            <h:panelGrid>
                                <h:panelGrid columns="2" >
                                    <p:outputLabel value="Fase" for="fas"/>
                                </h:panelGrid>
                                <h:panelGrid columns="2">
                                    <p:selectOneMenu id="fas" effect="fade" style="width: 350px" converter="#{indexConverter}" value="#{processoMB.processo.fase}" required="true"   >
                                        <f:selectItems value="#{faseMB.listaFases}" var="fas" itemLabel="#{fas.nome} --> #{fas.usuario.nome} (#{fas.prazo} dias) " itemValue="#{fas}"/>
                                    </p:selectOneMenu>
                                </h:panelGrid>
                            </h:panelGrid>
                            <h:panelGrid>
                                <h:panelGrid columns="2" >
                                    <p:outputLabel value="Materia" for="mat"/>
                                </h:panelGrid>
                                <h:panelGrid columns="2">
                                    <p:selectOneMenu id="mat" effect="fade" style="width: 350px" converter="#{indexConverter}" value="#{processoMB.processo.materia}" required="true"   >
                                        <f:selectItems value="#{materiaMB.listaMaterias}" var="mat" itemLabel="#{mat.nome}" itemValue="#{mat}"/>
                                    </p:selectOneMenu>
                                </h:panelGrid>
                            </h:panelGrid>
                            <h:panelGrid id="grdObj"  >
                                <h:panelGrid >                                   
                                    <p:outputLabel value="Objeto" for="input_componente_obj"/>
                                    <h:panelGrid columns="3">
                                        <p:inputTextarea rows="5" cols="30" value="#{processoMB.processo.objetoProcesso }" id="input_componente_obj"  />
                                    </h:panelGrid>
                                </h:panelGrid>
                            </h:panelGrid>
                            <h:panelGrid>
                                <h:panelGrid columns="2" >
                                    <p:outputLabel value="Juizo" for="juz"/>
                                </h:panelGrid>
                                <h:panelGrid columns="2">
                                    <p:selectOneMenu id="juz" effect="fade" style="width: 350px" converter="#{indexConverter}" value="#{processoMB.processo.juizoTribunal}" required="true"   >
                                        <f:selectItems value="#{juizoTribunalMB.listaJuizoTribunals}" var="juz" itemLabel="#{juz.nome}" itemValue="#{juz}"/>
                                    </p:selectOneMenu>
                                </h:panelGrid>
                            </h:panelGrid>
                            <h:panelGrid >
                                <h:panelGrid columns="2" >
                                    <p:outputLabel value="Advogado" for="adv"/>
                                </h:panelGrid>
                                <h:panelGrid columns="2">
                                    <p:selectOneMenu id="adv" effect="fade" style="width: 350px" converter="#{indexConverter}" value="#{processoMB.processo.advogado}" required="true"   >
                                        <f:selectItems value="#{advogadoMB.listaAdvogados}" var="ad" itemLabel="#{ad.nome}" itemValue="#{ad}"/>
                                    </p:selectOneMenu>
                                </h:panelGrid>
                            </h:panelGrid>

                            <comp:inputTextArea nomeLabel="Observações" value="#{processoMB.processo.observacoes}" coluna="50" linha="5"  />
                        </h:panelGrid>
                        <h:panelGrid width="100%" id="grdParte">
                            <h:panelGrid id="grdInt"  >
                                <p:panel style="text-align: center" header="Partes Interessadas">
                                    <h:panelGrid   >
                                        <h:panelGrid>
                                            <p:outputLabel value="Interessado" for="input_componente_int"/>
                                            <h:panelGrid columns="3">
                                                <p:inputText value="#{processoMB.parteInteressada.cliente.pessoa.nome}" id="input_componente_int" readonly="true" size="27"/>
                                                <p:commandButton icon="ui-icon-search"  onclick="PF('dialogoConIntere').show()"  immediate="true"/>
                                            </h:panelGrid>
                                        </h:panelGrid>
                                        <h:panelGrid columns="2">
                                            <comp:inputText require="false" nomeLabel="Representante\Qualificação" value="#{processoMB.parteInteressada.representante}" size="70" />
                                            <p:commandButton style="margin-top: 23px" value="Adicionar"  actionListener="#{processoMB.addInteressado()}" update="@form"  icon="ui-icon-circle-plus"  />
                                        </h:panelGrid>
                                    </h:panelGrid>
                                    <p:dataTable value="#{processoMB.processo.parteInteressadas}" id="tabelaInt" paginatorAlwaysVisible="false" paginator="true" var="t" rows="10"
                                                 rowStyleClass="#{(empty rowIx or rowIx mod 2 ne 0 ? 'even-row' : 'odd-row')}"
                                                 rowIndexVar="rowIx" emptyMessage="#{mensagens['consulta.vazia']}">

                                        <p:column headerText="Nome" sortBy="#{t.cliente.pessoa.nome}">
                                            <comp:outputText value="#{t.cliente.pessoa.nome}"/>
                                        </p:column>
                                        <p:column headerText="Representante" >
                                            <comp:outputText value="#{t.representante}"/>
                                        </p:column>
                                        <p:column headerText="Ação" width="10%"  style="text-align: center">
                                            <comp:commandButton_excluir acao_butao="#{processoMB.delInteressado(t, processoMB.processo)}" classe="Interessado" form_to_update="@form"/>
                                        </p:column>
                                    </p:dataTable>
                                </p:panel>
                            </h:panelGrid>

                            <h:panelGrid id="grdIntAdv"  >
                                <p:panel style="text-align: center" header="Adversário">
                                    <h:panelGrid   >
                                        <h:panelGrid>
                                            <p:outputLabel value="Adversário" for="input_componente_adv"/>
                                            <h:panelGrid columns="3">
                                                <p:inputText value="#{processoMB.adversario.cliente.pessoa.nome}" id="input_componente_adv"  readonly="true" size="27"/>
                                                <p:commandButton icon="ui-icon-search"  onclick="PF('dialogoConAdv').show()"  immediate="true"/>
                                            </h:panelGrid>
                                        </h:panelGrid>
                                        <h:panelGrid columns="2">
                                            <comp:inputText nomeLabel="Representante\Qualificação" require="false" value="#{processoMB.adversario.representante}" size="70" />
                                            <p:commandButton style="margin-top: 23px" value="Adicionar"  actionListener="#{processoMB.addAdversario()}" update="@form"  icon="ui-icon-circle-plus"  />
                                        </h:panelGrid>
                                    </h:panelGrid>
                                    <p:dataTable value="#{processoMB.processo.adversarios}" id="tabelaAdv" paginatorAlwaysVisible="false" paginator="true" var="t2" rows="10"
                                                 rowStyleClass="#{(empty rowIx or rowIx mod 2 ne 0 ? 'even-row' : 'odd-row')}"
                                                 rowIndexVar="rowIx" emptyMessage="#{mensagens['consulta.vazia']}">

                                        <p:column headerText="Nome" sortBy="#{t2.cliente.pessoa.nome}">
                                            <comp:outputText value="#{t2.cliente.pessoa.nome}"/>
                                        </p:column>
                                        <p:column headerText="Representante" >
                                            <comp:outputText value="#{t2.representante}"/>
                                        </p:column>
                                        <p:column headerText="Ação" width="10%" style="text-align: center">
                                            <comp:commandButton_excluir acao_butao="#{processoMB.delAdversario(t2, processoMB.processo)}" classe="Adversário" form_to_update="@form"/>

                                        </p:column>
                                    </p:dataTable>
                                </p:panel>
                            </h:panelGrid>
                        </h:panelGrid>

                    </h:panelGrid>

                </p:tab>
                <p:tab id="tabInteressados" title="Interessados">

                </p:tab>
                <p:tab id="tabAdversario" title="Adversário">

                </p:tab>
                <p:tab id="tabFatos" title="Dos Fatos">
                    <comp:inputTextArea  nomeLabel="Dos Fatos" value="#{processoMB.processo.fatos}" coluna="100" linha="20"  />

                </p:tab>
                <p:tab id="tabProvas" title="Das Provas">
                    <comp:inputTextArea nomeLabel="Das Provas" value="#{processoMB.processo.provas}" coluna="100" linha="20"  />


                </p:tab>
                <p:tab id="tabInfo" title="Informações Reservadas">
                    <comp:inputTextArea nomeLabel="Informações Reservadas" value="#{processoMB.processo.informacaoReservada}" coluna="100" linha="20"  />


                </p:tab>
                <p:tab id="tabDadProces" title="Dados Processuais">
                    <h:panelGrid columns="3">
                        <h:panelGrid>
                            <p:outputLabel value="NB Indeferido" for="nb"/>
                            <p:inputText id="nb" onkeypress="return soNumero()" value="#{processoMB.processo.nbIndeferido}" />
                        </h:panelGrid>
                        <h:panelGrid>
                            <comp:inputTextCalendar nomeLabel="DER" size="15" valorData="#{processoMB.processo.der}" />
                        </h:panelGrid>

                    </h:panelGrid>
                    <h:panelGrid columns="3">
                        <h:panelGrid>
                            <comp:inputTextArea nomeLabel="Motivo Indeferimento/Cessação" value="#{processoMB.processo.motivoIndeferimento}" coluna="50" linha="5"/>
                        </h:panelGrid>
                        <h:panelGrid>
                            <comp:inputTextArea nomeLabel="Incapacidade/Causa da Morte" value="#{processoMB.processo.incapacidade}" coluna="50" linha="5"/>
                        </h:panelGrid>

                    </h:panelGrid>
                    <h:panelGrid columns="2">
                        <h:panelGrid>
                            <comp:inputTextArea nomeLabel="Filho/Cônjuge/Falecido" value="#{processoMB.processo.dependente}" coluna="50" linha="5"/>
                        </h:panelGrid>
                        <h:panelGrid>

                            <h:panelGrid columns="2"> 
                                <h:panelGrid>
                                    <p:outputLabel value="NB Deferido" />
                                    <p:inputText  onkeypress="return soNumero()"  value="#{processoMB.processo.nbDeferido}" />
                                </h:panelGrid>
                                <h:panelGrid>
                                    <comp:inputTextCalendar nomeLabel="DCB" size="15" valorData="#{processoMB.processo.dcb}" />
                                </h:panelGrid>
                            </h:panelGrid>
                            <h:panelGrid columns="2"> 
                                <h:panelGrid>
                                    <comp:inputTextCalendar nomeLabel="DIB" size="15" valorData="#{processoMB.processo.dib}" />
                                </h:panelGrid>
                                <h:panelGrid>
                                    <comp:inputTextCalendar nomeLabel="DIP" size="15" valorData="#{processoMB.processo.dip}" />
                                </h:panelGrid>
                            </h:panelGrid>
                        </h:panelGrid>

                    </h:panelGrid>

                </p:tab>
                <p:tab id="tabMov" title="Movimentações">
                    <consultas:MovimentacaoConsulta />
                </p:tab>
                <p:tab id="tabEvent" title="Eventos">
                    <p:dataTable value="#{processoMB.listaEventos}" id="tabelaEven" paginatorAlwaysVisible="false"  paginator="true" var="ev" rows="10" 
                                 rowStyleClass="#{(empty rowIx or rowIx mod 2 ne 0 ? 'even-row' : 'odd-row')}"
                                 rowIndexVar="rowIx" emptyMessage="#{mensagens['consulta.vazia']}">
                        <p:column headerText="Nome" width="10%" sortBy="#{t.nome}">
                            <comp:outputText value="#{ev.nome}"/>
                        </p:column>
                        <p:column headerText="Tipo" width="10%" >
                            <comp:outputText value="#{ev.especieEvento.nome}"/>
                        </p:column>
                        <p:column headerText="Descrição" width="30%" >
                            <comp:outputText value="#{ev.observacao}"/>
                        </p:column>
                        <p:column headerText="Participante" width="10%" >
                            <comp:outputText value="#{t.usuario.nome}"/>
                        </p:column>
                        <p:column headerText="Data" width="5%" >
                            <comp:outputText tipo="d" value="#{ev.data}"/>
                        </p:column>
                        <p:column headerText="Ação" id="acao" width="3%" style="text-align: center">
                            <p:commandButton  style="width: 22px;height: 22px" actionListener="#{eventoMB.imprimirEvento(ev)}"  oncomplete="popup('/atus/RelatorioServlet.pdf');" id="btnEvent" icon="ui-icon-print" />

                        </p:column>

                    </p:dataTable>
                </p:tab>
                <p:tab id="tabCus" title="Custos e Despesas">
                    <h:panelGrid>
                        <h:panelGrid columns="2" >
                            <p:outputLabel value="Valor" for="var"/>
                            <p:message for="var"/>
                        </h:panelGrid>
                        <p:inputText value="#{processoMB.processo.valor}"  id="var" size="7" converter="#{converterBigDecimal}"  styleClass="edtMoeda" onfocus="mascaraInputs();" required="true" requiredMessage="#{mensagens['require']}">
                        </p:inputText>
                    </h:panelGrid>
                </p:tab>

            </p:tabView>



        </p:fieldset>
    </composite:implementation>
</ui:composition>




